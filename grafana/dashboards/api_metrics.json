{
  "title": "API Metrics",
  "panels": [
    {"type": "stat", "title": "5xx % (5m)", "targets": [{"expr": "100 * sum(rate(cb_http_requests_total{status=~\"5..\"}[5m])) / sum(rate(cb_http_requests_total[5m]))"}]},
    {"type": "graph", "title": "Requests RPS", "targets": [{"expr": "sum(rate(cb_http_requests_total[1m]))"}]},
    {"type": "graph", "title": "Latency p95", "targets": [{"expr": "histogram_quantile(0.95, sum(rate(cb_request_latency_seconds_bucket[5m])) by (le))"}]},
    {"type": "graph", "title": "Provider Error Rate", "targets": [{"expr": "sum(rate(cb_provider_errors_total[5m])) by (provider)"}]},
    {"type": "graph", "title": "Circuit State (Open=1)", "targets": [{"expr": "max(cb_circuit_open) by (provider)"}]},
    {"type": "graph", "title": "Rate Limit Denied", "targets": [{"expr": "sum(rate(cb_rate_limit_denied_total[1m]))"}]},
    {"type": "graph", "title": "Budget Tokens (5m)", "targets": [{"expr": "sum(increase(cb_budget_tokens_total[5m]))"}]},
    {"type": "graph", "title": "Budget USD (5m)", "targets": [{"expr": "sum(increase(cb_budget_usd_total[5m]))"}]}
  ]
}